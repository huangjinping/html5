<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>微信回调页面</title>
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <script src="https://res.wx.qq.com/open/js/jweixin-1.3.2.js"></script>
    <style>
        .wrap {
            background-color: white;
            text-align: center;
        }

        button {
            width: 10rem;
            height: 10rem;
            line-height: 10rem;
            background-color: #ccc;
            margin: 2rem 0;
            border: 0;
        }

    </style>

</head>
<body>

<div class="wrap">
    <p id="systemName"></p>
    <button id="btn_request">回调微信</button>
</div>
</body>
<script>
    var btn = document.getElementById("btn_request");
    btn.addEventListener('click', function (e) {
        console.log(e);
//        wx.miniProgram.navigateBack({})
        ready();
    });


    // web-view下的页面内
    function ready() {
        console.log("=========>>>>>>");
        var btn = document.getElementById("btn_request");
        var systemName = document.getElementById("systemName");
        var ua = window.navigator.userAgent.toLowerCase();
        if (ua.match(/MicroMessenger/i) == 'micromessenger') {    //判断是否是微信环境

            //微信环境
            wx.miniProgram.getEnv(function (res) {
                if (res.miniprogram) {
                    systemName.innerText = "小程序环境";
                    wx.miniProgram.navigateBack({})

                } else {
                    systemName.innerText = "非小程序";
                    location.href="https://www.hdfex.com/creditCard/FunfujunHH5/home.html";
                }
            })
        } else {
            //
            systemName.innerText = "非微信";
            location.href="https://www.hdfex.com/creditCard/FunfujunHH5/home.html";


        }
    }
    ready()
</script>
</html>